<code><pre>
#include<cstdio>
#include<vector>
using namespace std;
const int N=10001,inf=0x3f3f3f3f;
int s,t,n,m,gap[N],d[N];
struct edge{int to,cap,rev;}; vector<edge> G[N];
int dfs(int x,int flow){
	if(x==t) return flow;
	int ret=flow,mind=n-1;
	for(int i=0;i<G[x].size();++i){
		edge &e=G[x][i];
		if(e.cap){
			if(d[x]==d[e.to]+1){
				int f=dfs(e.to,min(e.cap,ret));
				e.cap-=f; G[e.to][e.rev].cap+=f; ret-=f;
				if(d[s]>=n) return flow-ret; if(!ret) break;
			}
			mind=min(mind,d[e.to]);
		}
	}
	if(ret==flow){
		if(!--gap[d[x]]) d[s]=n;
		d[x]=mind+1; ++gap[d[x]];
	}
	return flow-ret;
}
int main(){
	scanf("%d%d%d%d",&n,&m,&s,&t);
	for(int i=1;i<=m;++i){
		int u,v,w; scanf("%d%d%d",&u,&v,&w);
		G[u].push_back({v,w,G[v].size()});
		G[v].push_back({u,0,G[u].size()-1});
	}
	gap[s]=n; int ans=0; for(;d[s]<n;ans+=dfs(s,inf));
	printf("%d",ans); return 0;
}
</pre></code>
